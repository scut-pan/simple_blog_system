# 简易博客系统开发指南

## 📋 项目概述

**项目名称**：简易个人博客系统  
**技术栈**：Flask + SQLite + Jinja2 + HTML/CSS  
**核心功能**：文章发布、编辑、删除、查看  
**开发时间**：建议2天完成  
**提交截止**：2025年12月21日

---

## 🎯 学习目标

通过这个项目，你将学习到：
- Flask Web 框架的基本使用
- SQLite 数据库的增删改查操作
- Jinja2 模板引擎的使用
- HTTP 请求方法（GET、POST）
- HTML 表单处理
- 面向对象编程在实际项目中的应用

---

## 📂 项目结构规划

在开始编码之前，先规划好项目结构：

```
simple_blog_system/
├── main.py                 # 程序入口文件
├── pyproject.toml          # 项目配置文件
├── README.md               # 项目说明文档
├── src/
│   ├── __init__.py         # 包初始化文件
│   ├── app.py              # Flask 应用主文件
│   ├── models.py           # 数据库模型
│   ├── database.py         # 数据库操作
│   └── templates/          # HTML 模板文件夹
│       ├── base.html       # 基础模板
│       ├── index.html      # 首页（文章列表）
│       ├── post.html       # 文章详情页
│       ├── create.html     # 创建文章页
│       └── edit.html       # 编辑文章页
│   └── static/             # 静态文件文件夹
│       └── style.css       # 样式文件
├── blog.db                 # SQLite 数据库文件（运行后自动生成）
└── docs/                   # 文档文件夹
```

---

## 🚀 开发步骤

### **阶段一：环境准备与项目初始化**

#### 步骤 1.1：安装依赖

在项目根目录使用 uv 安装 Flask：

```bash
uv add flask
```

#### 步骤 1.2：创建项目基础结构

需要创建以下空文件和文件夹：
- `src/__init__.py`
- `src/app.py`
- `src/models.py`
- `src/database.py`
- `src/templates/` 文件夹
- `src/static/` 文件夹

**注意事项**：
- `__init__.py` 文件可以为空，它的作用是让 Python 将 `src` 目录识别为一个包
- 使用 VS Code 可以直接右键创建文件和文件夹

---

### **阶段二：数据库设计与实现**

#### 步骤 2.1：设计博客文章数据模型

在 `src/models.py` 中，设计一个博客文章类。

**需要的字段**：
- `id`：文章唯一标识（整数，自增主键）
- `title`：文章标题（字符串，不能为空）
- `content`：文章内容（文本）
- `created_at`：创建时间（时间戳）
- `updated_at`：更新时间（时间戳）

**参考知识点**：
- 使用 Python 的 `dataclass` 装饰器可以简化类的定义
- 需要导入 `from dataclasses import dataclass`
- 需要导入 `from datetime import datetime`

**代码提示**：
```python
@dataclass
class Post:
    id: int
    title: str
    content: str
    created_at: datetime
    updated_at: datetime
```

#### 步骤 2.2：实现数据库操作类

在 `src/database.py` 中，创建一个 `Database` 类，实现数据库的增删改查操作。

**需要实现的方法**：
1. `__init__(self, db_path)`：初始化数据库连接
2. `create_table()`：创建文章表
3. `create_post(title, content)`：创建新文章
4. `get_all_posts()`：获取所有文章
5. `get_post_by_id(post_id)`：根据 ID 获取文章
6. `update_post(post_id, title, content)`：更新文章
7. `delete_post(post_id)`：删除文章
8. `close()`：关闭数据库连接

**关键知识点**：
- 使用 `sqlite3` 模块（Python 内置，不需要额外安装）
- SQL 语句的基本用法（CREATE TABLE、INSERT、SELECT、UPDATE、DELETE）
- 使用参数化查询防止 SQL 注入：`cursor.execute("SELECT * FROM posts WHERE id = ?", (post_id,))`

**SQL 表结构参考**：
```sql
CREATE TABLE IF NOT EXISTS posts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)
```

**注意事项**：
- 每次数据库操作后要 `commit()` 提交事务
- 使用 `fetchall()` 获取所有结果，`fetchone()` 获取单条结果
- 从数据库查询的结果需要转换成 `Post` 对象

---

### **阶段三：Flask 应用开发**

#### 步骤 3.1：创建 Flask 应用

在 `src/app.py` 中创建 Flask 应用实例。

**基本结构**：
```python
from flask import Flask, render_template, request, redirect, url_for
from .database import Database
from .models import Post

app = Flask(__name__)
db = Database('blog.db')

# 初始化数据库
db.create_table()
```

**注意事项**：
- `Flask(__name__)` 创建应用实例
- 需要指定数据库文件路径
- 应用启动时调用 `create_table()` 确保表存在

#### 步骤 3.2：实现路由和视图函数

Flask 应用需要实现以下路由：

##### **路由 1：首页（文章列表）**
- **URL**：`/`
- **方法**：GET
- **功能**：显示所有文章的列表
- **模板**：`index.html`

**知识点**：
- 使用 `@app.route('/')` 装饰器定义路由
- 使用 `db.get_all_posts()` 获取所有文章
- 使用 `render_template()` 渲染模板

##### **路由 2：文章详情页**
- **URL**：`/post/<int:post_id>`
- **方法**：GET
- **功能**：显示单篇文章的完整内容
- **模板**：`post.html`

**知识点**：
- 使用 `<int:post_id>` 接收整数类型的 URL 参数
- 如果文章不存在，可以返回 404 错误

##### **路由 3：创建文章页**
- **URL**：`/create`
- **方法**：GET（显示表单）、POST（提交表单）
- **功能**：显示创建文章的表单，处理表单提交
- **模板**：`create.html`

**知识点**：
- 使用 `methods=['GET', 'POST']` 支持多种请求方法
- 使用 `request.method` 判断请求类型
- 使用 `request.form['字段名']` 获取表单数据
- 创建成功后使用 `redirect(url_for('index'))` 重定向到首页

##### **路由 4：编辑文章页**
- **URL**：`/edit/<int:post_id>`
- **方法**：GET（显示表单）、POST（提交表单）
- **功能**：显示编辑文章的表单，处理表单提交
- **模板**：`edit.html`

**知识点**：
- GET 请求时，先获取文章数据并填充到表单
- POST 请求时，更新文章数据

##### **路由 5：删除文章**
- **URL**：`/delete/<int:post_id>`
- **方法**：POST
- **功能**：删除指定文章

**知识点**：
- 删除操作建议使用 POST 方法，避免误删
- 删除后重定向到首页

#### 步骤 3.3：添加应用启动函数

在 `src/app.py` 底部添加：

```python
def run():
    app.run(debug=True, host='0.0.0.0', port=5000)
```

**注意事项**：
- `debug=True` 开启调试模式，修改代码后自动重启
- `host='0.0.0.0'` 允许外部访问
- `port=5000` 指定端口号

---

### **阶段四：模板开发**

#### 步骤 4.1：创建基础模板

在 `src/templates/base.html` 中创建基础模板，其他模板继承它。

**基础模板结构**：
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %} - 简易博客</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>我的博客</h1>
        <nav>
            <a href="/">首页</a>
            <a href="/create">写文章</a>
        </nav>
    </header>
    
    <main>
        {% block content %}{% endblock %}
    </main>
    
    <footer>
        <p>&copy; 2025 简易博客系统</p>
    </footer>
</body>
</html>
```

**Jinja2 语法知识点**：
- `{% block name %}{% endblock %}`：定义可被子模板覆盖的块
- `{{ 变量名 }}`：输出变量
- `url_for('static', filename='...')`：生成静态文件 URL
- `url_for('函数名')`：生成路由 URL

#### 步骤 4.2：创建首页模板

在 `src/templates/index.html` 中显示文章列表。

**需要实现的功能**：
- 继承 `base.html`
- 循环显示所有文章（标题、创建时间、部分内容）
- 每篇文章提供"查看详情"链接
- 如果没有文章，显示提示信息

**Jinja2 循环语法**：
```html
{% for post in posts %}
    <!-- 显示文章 -->
{% endfor %}

{% if not posts %}
    <p>还没有文章，快去创建吧！</p>
{% endif %}
```

**时间格式化**：
```html
{{ post.created_at.strftime('%Y-%m-%d %H:%M') }}
```

#### 步骤 4.3：创建文章详情模板

在 `src/templates/post.html` 中显示单篇文章的完整内容。

**需要实现的功能**：
- 显示标题、内容、创建时间、更新时间
- 提供"编辑"和"删除"按钮
- 删除按钮需要使用 POST 表单提交

**删除表单参考**：
```html
<form method="POST" action="{{ url_for('delete_post', post_id=post.id) }}" 
      onsubmit="return confirm('确定要删除这篇文章吗？')">
    <button type="submit">删除</button>
</form>
```

#### 步骤 4.4：创建创建文章模板

在 `src/templates/create.html` 中创建文章表单。

**需要实现的功能**：
- 标题输入框（`<input type="text">`）
- 内容输入框（`<textarea>`）
- 提交按钮

**表单参考**：
```html
<form method="POST">
    <label>标题：
        <input type="text" name="title" required>
    </label>
    
    <label>内容：
        <textarea name="content" rows="15" required></textarea>
    </label>
    
    <button type="submit">发布</button>
</form>
```

**注意事项**：
- `method="POST"` 使用 POST 方法
- `name` 属性对应 Flask 中 `request.form['name']`
- `required` 属性表示必填项

#### 步骤 4.5：创建编辑文章模板

在 `src/templates/edit.html` 中创建编辑表单。

**需要实现的功能**：
- 与创建表单类似
- 表单中填充现有文章的标题和内容

**预填充表单数据**：
```html
<input type="text" name="title" value="{{ post.title }}" required>
<textarea name="content" rows="15" required>{{ post.content }}</textarea>
```

---

### **阶段五：样式美化**

#### 步骤 5.1：创建 CSS 样式文件

在 `src/static/style.css` 中添加基本样式。

**建议的样式**：
- 页面整体布局（居中、最大宽度）
- 文章列表样式（卡片式布局）
- 表单样式（输入框、按钮美化）
- 导航栏样式

**CSS 基础结构参考**：
```css
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

header {
    background: #333;
    color: white;
    padding: 20px;
    margin-bottom: 20px;
}

/* 更多样式... */
```

**注意事项**：
- 保持样式简洁，不要过度设计
- 确保文本可读性（字号、行高、对比度）
- 可以参考一些简洁的博客样式

---

### **阶段六：程序入口文件**

#### 步骤 6.1：修改 main.py

在 `main.py` 中导入并启动 Flask 应用。

**代码结构**：
```python
from src.app import run

if __name__ == "__main__":
    run()
```

**注意事项**：
- 这个文件是程序的入口点
- 运行 `python main.py` 或 `uv run main.py` 启动应用

---

### **阶段七：测试与调试**

#### 步骤 7.1：运行应用

在终端运行：
```bash
uv run main.py
```

打开浏览器访问：`http://localhost:5000`

#### 步骤 7.2：功能测试清单

**必测功能**：
- [ ] 访问首页，查看是否正常显示
- [ ] 创建一篇文章，检查是否成功保存
- [ ] 在首页查看文章列表
- [ ] 点击文章标题，查看详情页
- [ ] 编辑文章，检查是否成功更新
- [ ] 删除文章，检查是否成功删除
- [ ] 测试表单验证（空标题、空内容）
- [ ] 测试边界情况（超长标题、超长内容）

#### 步骤 7.3：常见问题排查

**问题 1：ModuleNotFoundError**
- 检查 `__init__.py` 文件是否存在
- 检查导入路径是否正确

**问题 2：数据库操作失败**
- 检查 SQL 语句是否正确
- 检查是否调用了 `commit()`
- 打印 SQL 语句和参数进行调试

**问题 3：模板未找到**
- 检查模板文件是否在 `src/templates/` 目录下
- 检查模板文件名拼写是否正确

**问题 4：静态文件加载失败**
- 检查 CSS 文件是否在 `src/static/` 目录下
- 检查 `url_for('static', ...)` 语法是否正确

---

## 🎨 可选扩展功能

如果你完成了基础功能并且有时间，可以尝试添加以下扩展：

### 扩展 1：Markdown 支持
- 安装 `markdown` 库：`uv add markdown`
- 在显示文章内容时，将 Markdown 转换为 HTML
- 参考代码：`markdown.markdown(post.content)`

### 扩展 2：文章搜索
- 添加搜索框
- 在数据库中实现模糊搜索（使用 `LIKE` 语句）

### 扩展 3：分类/标签
- 为文章添加分类或标签字段
- 实现按分类筛选功能

### 扩展 4：分页功能
- 当文章数量较多时，实现分页显示
- 可以使用 Flask-SQLAlchemy 的分页功能

### 扩展 5：评论功能
- 创建评论表
- 实现评论的增删改查

---

## 📝 项目报告撰写指南

### 报告应包含的内容：

#### 1. 项目设计思路
- 为什么选择博客系统？
- 技术栈选择的原因（为什么用 Flask 和 SQLite？）
- 项目功能模块划分
- 数据库设计（表结构、字段说明）

#### 2. 重要代码说明
- **数据库操作部分**：展示 CRUD 操作的实现
- **Flask 路由部分**：展示关键路由的实现逻辑
- **模板渲染部分**：展示 Jinja2 模板的使用

**注意**：不要只贴代码，要有解释说明每段代码的作用和实现思路。

#### 3. 运行结果截图
- 首页（文章列表）
- 创建文章页面
- 文章详情页
- 编辑文章页面
- 数据库中的数据截图（可选）

#### 4. 项目总结
- 在项目中学到了什么？
- 遇到了哪些困难，如何解决的？
- 还有哪些可以改进的地方？

---

## 🔧 常用的 Python 语法和技巧

### 1. SQLite 数据库操作

```python
import sqlite3

# 连接数据库
conn = sqlite3.connect('blog.db')
cursor = conn.cursor()

# 执行 SQL
cursor.execute("SELECT * FROM posts")
results = cursor.fetchall()  # 获取所有结果
result = cursor.fetchone()   # 获取一条结果

# 参数化查询（防止 SQL 注入）
cursor.execute("SELECT * FROM posts WHERE id = ?", (post_id,))

# 提交事务
conn.commit()

# 关闭连接
conn.close()
```

### 2. Flask 路由和视图

```python
from flask import Flask, render_template, request, redirect, url_for

app = Flask(__name__)

# GET 请求
@app.route('/')
def index():
    return render_template('index.html')

# 带参数的路由
@app.route('/post/<int:post_id>')
def view_post(post_id):
    return f"文章 ID: {post_id}"

# 支持 GET 和 POST
@app.route('/create', methods=['GET', 'POST'])
def create():
    if request.method == 'POST':
        title = request.form['title']
        content = request.form['content']
        # 处理表单数据...
        return redirect(url_for('index'))
    return render_template('create.html')
```

### 3. Jinja2 模板语法

```html
<!-- 继承模板 -->
{% extends "base.html" %}

<!-- 覆盖块 -->
{% block title %}首页{% endblock %}

{% block content %}
    <!-- 条件语句 -->
    {% if posts %}
        <!-- 循环 -->
        {% for post in posts %}
            <h2>{{ post.title }}</h2>
            <p>{{ post.content }}</p>
        {% endfor %}
    {% else %}
        <p>没有文章</p>
    {% endif %}
{% endblock %}

<!-- 生成 URL -->
<a href="{{ url_for('view_post', post_id=post.id) }}">查看详情</a>

<!-- 过滤器 -->
{{ post.content|truncate(100) }}  <!-- 截取前100个字符 -->
{{ post.title|upper }}  <!-- 转大写 -->
```

### 4. 日期时间处理

```python
from datetime import datetime

# 获取当前时间
now = datetime.now()

# 格式化时间
formatted = now.strftime('%Y-%m-%d %H:%M:%S')

# 字符串转时间
dt = datetime.strptime('2025-12-20', '%Y-%m-%d')
```

---

## ⚠️ 重要注意事项

1. **代码规范**：
   - 使用有意义的变量名和函数名
   - 添加必要的注释
   - 保持代码缩进一致（建议 4 个空格）

2. **错误处理**：
   - 数据库操作要考虑异常情况
   - 用户输入要进行验证
   - 考虑边界情况（如文章不存在）

3. **安全性**：
   - 使用参数化查询防止 SQL 注入
   - 表单提交建议使用 POST 方法
   - 用户输入要进行转义（Flask 默认会转义）

4. **版本控制**（建议）：
   - 使用 Git 管理代码
   - 及时提交代码，避免丢失

5. **时间管理**：
   - 第一天完成后端和数据库
   - 第二天完成前端和测试
   - 留出时间写报告

---

## 📚 学习资源推荐

### 官方文档：
- [Flask 中文文档](https://dormousehole.readthedocs.io/)
- [SQLite 官方文档](https://www.sqlite.org/docs.html)
- [Jinja2 文档](https://jinja.palletsprojects.com/)

### 教程推荐：
- Flask Mega-Tutorial（非常详细的 Flask 教程）
- Real Python - Flask 系列文章

---

## ✅ 开发检查清单

### 基础功能：
- [ ] 创建项目文件结构
- [ ] 安装 Flask 依赖
- [ ] 实现数据库模型和操作
- [ ] 实现 Flask 应用和路由
- [ ] 创建所有必需的 HTML 模板
- [ ] 添加基本的 CSS 样式
- [ ] 完成 main.py 入口文件
- [ ] 测试所有功能

### 提交准备：
- [ ] 确保 `python main.py` 能正常运行
- [ ] 截取运行结果的屏幕截图
- [ ] 撰写项目报告
- [ ] 按要求打包文件
- [ ] 在截止日期前提交

---

## 💡 遇到问题时的求助方式

当你在开发过程中遇到问题时，可以这样向我求助：

1. **语法问题**：
   - "我想实现 XXX 功能，应该使用什么 Python 语法？"
   - "这段代码报错了，错误信息是 XXX，怎么解决？"

2. **功能实现**：
   - "我不知道如何实现 XXX 功能，能给我一些思路或示例代码吗？"
   - "我想实现 XXX 效果，但不知道从哪里开始"

3. **调试问题**：
   - "我的代码运行后出现 XXX 问题，可能是什么原因？"
   - "我的代码是 XXX，但是没有达到预期效果"

---

## 🎓 Python 设计哲学提醒

在编写代码时，记住 Python 之禅：

- **简单优于复杂**：不要过度设计，保持代码简洁
- **可读性很重要**：代码是给人读的，添加必要的注释
- **明确优于隐晦**：变量名要清楚表达意图
- **实用胜于纯粹**：先实现功能，再优化代码

---

## 🎉 最后的话

这个项目是一个完整的 Web 应用开发实践，涵盖了后端、数据库、前端等多个方面。通过自己动手实现，你会对 Web 开发有更深入的理解。

**记住**：
- 不要怕出错，调试是学习的一部分
- 遇到问题先自己尝试解决，实在不行再求助
- 每完成一个小功能就测试一下，确保它能正常工作
- 代码是写出来的，不是想出来的，开始动手吧！

**祝你开发顺利！** 💪
